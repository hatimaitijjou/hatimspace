<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ZENITH ‚àû OS | The Ultimate Global OS</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;500;700;900&display=swap" rel="stylesheet">
    <meta name="theme-color" content="#000000">
    
    <style>
        :root {
            --primary: #00d2ff; --secondary: #3a7bd5; --accent: #f80759;
            --glass-bg: rgba(20, 20, 30, 0.65); --glass-border: 1px solid rgba(255, 255, 255, 0.1);
            --blur: blur(25px); --font: 'Tajawal', sans-serif; --shadow: 0 10px 40px rgba(0,0,0,0.5);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: var(--font); user-select: none; -webkit-tap-highlight-color: transparent; }
        body { background: #000; height: 100vh; overflow: hidden; color: #fff; }

        /* --- Boot Screen --- */
        #boot-screen { position: fixed; inset: 0; background: #000; z-index: 99999; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: opacity 1s; }
        .logo-text { font-size: 4rem; font-weight: 900; letter-spacing: 5px; background: linear-gradient(45deg, var(--primary), #fff); -webkit-background-clip: text; -webkit-text-fill-color: transparent; animation: pulse 2s infinite; }
        .loader-container { width: 300px; height: 4px; background: #222; margin-top: 30px; border-radius: 2px; overflow: hidden; }
        .loader-bar { width: 0%; height: 100%; background: var(--primary); transition: width 3s ease-in-out; box-shadow: 0 0 15px var(--primary); }
        .boot-status { margin-top: 10px; color: #666; font-family: monospace; font-size: 0.9rem; }
        @keyframes pulse { 50% { opacity: 0.7; } }

        /* --- Background & Overlay --- */
        #wallpaper { position: fixed; inset: 0; z-index: -1; background: url('https://images.unsplash.com/photo-1534796636912-3b95b3ab5986?q=80&w=2072') center/cover; transition: 0.5s; }
        #wallpaper::after { content:''; position:absolute; inset:0; background:rgba(0,0,0,0.3); }

        /* --- Top Bar --- */
        #topbar { height: 35px; background: rgba(0,0,0,0.3); backdrop-filter: blur(10px); display: flex; justify-content: space-between; align-items: center; padding: 0 20px; font-size: 0.85rem; font-weight: bold; z-index: 5000; border-bottom: var(--glass-border); }

        /* --- Desktop --- */
        #desktop { position: absolute; inset: 0; top: 35px; bottom: 80px; padding: 20px; display: flex; gap: 20px; }
        .icon-grid { display: flex; flex-direction: column; flex-wrap: wrap; gap: 15px; height: 100%; align-content: flex-start; }
        .app-icon { width: 85px; display: flex; flex-direction: column; align-items: center; cursor: pointer; transition: 0.2s; text-shadow: 0 2px 4px black; border-radius: 10px; padding: 5px; }
        .app-icon:hover { background: rgba(255,255,255,0.1); backdrop-filter: blur(5px); }
        .icon-box { width: 60px; height: 60px; border-radius: 18px; display: flex; align-items: center; justify-content: center; font-size: 2rem; background: linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0.01)); border: var(--glass-border); box-shadow: 0 5px 15px rgba(0,0,0,0.3); margin-bottom: 5px; }

        /* --- Widgets --- */
        .widget-area { margin-right: auto; width: 320px; display: flex; flex-direction: column; gap: 15px; animation: slideIn 1s ease-out; }
        @keyframes slideIn { from{transform:translateX(-50px);opacity:0;} to{transform:translateX(0);opacity:1;} }
        .widget { background: var(--glass-bg); backdrop-filter: var(--blur); border-radius: 20px; padding: 20px; border: var(--glass-border); box-shadow: var(--shadow); transition: 0.3s; }
        .widget:hover { transform: translateY(-5px); }
        .ai-input { width: 100%; padding: 10px; background: rgba(0,0,0,0.3); border: 1px solid #444; border-radius: 8px; color: white; margin-top: 10px; outline: none; }

        /* --- Dock --- */
        #dock-container { position: fixed; bottom: 15px; left: 0; right: 0; display: flex; justify-content: center; z-index: 9000; }
        #dock { background: rgba(20, 20, 30, 0.75); backdrop-filter: blur(30px); padding: 10px 20px; border-radius: 24px; border: var(--glass-border); display: flex; gap: 15px; align-items: flex-end; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .dock-item { width: 50px; height: 50px; border-radius: 14px; background: rgba(255,255,255,0.05); display: flex; align-items: center; justify-content: center; font-size: 1.5rem; cursor: pointer; transition: 0.2s cubic-bezier(0.25,1,0.5,1); position: relative; border-bottom: 2px solid transparent; }
        .dock-item:hover { transform: translateY(-15px) scale(1.2); background: rgba(255,255,255,0.2); margin: 0 10px; }
        .dock-item.active::after { content:''; position:absolute; bottom:-5px; width:5px; height:5px; background:var(--primary); border-radius:50%; }

        /* --- Windows --- */
        .window { position: absolute; background: #121212; border-radius: 12px; border: 1px solid #333; display: flex; flex-direction: column; box-shadow: 0 30px 60px rgba(0,0,0,0.7); min-width: 350px; min-height: 250px; overflow: hidden; animation: popIn 0.3s cubic-bezier(0.1,0.9,0.2,1); resize: both; }
        @keyframes popIn { from{opacity:0; transform:scale(0.9);} to{opacity:1; transform:scale(1);} }
        .win-head { height: 40px; background: #1c1c24; display: flex; justify-content: space-between; align-items: center; padding: 0 15px; cursor: grab; border-bottom: 1px solid #333; user-select: none; }
        .win-controls { display: flex; gap: 8px; }
        .win-dot { width: 12px; height: 12px; border-radius: 50%; cursor: pointer; transition: 0.2s; }
        .close { background: #ff5f57; } .close:hover { filter:brightness(0.8); }
        .min { background: #febc2e; } .max { background: #28c840; }
        .win-body { flex: 1; position: relative; overflow: hidden; background: #0e0e12; }

        /* --- Start Menu --- */
        #start-menu { position: fixed; bottom: 85px; left: 50%; transform: translateX(-50%) translateY(20px); width: 350px; background: rgba(20,20,30,0.95); backdrop-filter: blur(40px); border: var(--glass-border); border-radius: 20px; padding: 20px; display: none; flex-direction: column; gap: 15px; opacity: 0; transition: 0.3s; z-index: 8999; }
        #start-menu.show { display: flex; transform: translateX(-50%) translateY(0); opacity: 1; }
        .start-item { display: flex; align-items: center; gap: 15px; padding: 10px; border-radius: 10px; cursor: pointer; transition: 0.2s; }
        .start-item:hover { background: rgba(255,255,255,0.1); }

        /* --- App Specific Styles --- */
        .browser-bar { display: flex; gap: 10px; padding: 8px; background: #222; }
        .url-in { flex: 1; background: #111; border: none; color: white; padding: 5px 10px; border-radius: 5px; }
        .paint-tools { padding: 10px; background: #222; display: flex; gap: 10px; justify-content: center; }
        .color-dot { width: 20px; height: 20px; border-radius: 50%; cursor: pointer; border: 2px solid #555; }
        .color-dot.active { border-color: white; transform: scale(1.2); }
        .term-box { background: #0c0c0c; color: #0f0; padding: 15px; font-family: monospace; height: 100%; overflow-y: auto; }
        .term-in { background: transparent; border: none; color: #0f0; outline: none; width: 100%; font-family: monospace; }
        .xo-board { display: grid; grid-template-columns: repeat(3, 1fr); gap: 5px; width: 200px; margin: 20px auto; }
        .xo-cell { width: 60px; height: 60px; background: #222; display: flex; align-items: center; justify-content: center; font-size: 2rem; cursor: pointer; border-radius: 5px; font-weight: bold; }
        .xo-cell:hover { background: #333; }

        #toast { position: fixed; top: 50px; right: 20px; background: rgba(20,20,30,0.9); border-left: 4px solid var(--primary); padding: 15px; border-radius: 8px; transform: translateX(150%); transition: 0.5s; z-index: 9999; display: flex; align-items: center; gap: 10px; }
    </style>
</head>
<body>

    <!-- Boot Screen -->
    <div id="boot-screen">
        <div class="logo-text">ZENITH ‚àû</div>
        <div style="letter-spacing: 2px; color: #aaa;">UNIVERSAL EDITION</div>
        <div class="loader-container"><div class="loader-bar" id="load-bar"></div></div>
        <div class="boot-status" id="boot-text">Initializing Kernel...</div>
    </div>

    <div id="wallpaper"></div>

    <!-- Top Bar -->
    <div id="topbar">
        <div style="display:flex; gap:15px; align-items:center;">
            <i class="fab fa-battle-net" style="font-size:1.2rem; color:var(--primary);"></i>
            <span>ZENITH ‚àû</span>
            <span style="font-size:0.7rem; color:#aaa;">Global Users: <span id="users-cnt" style="color:var(--primary); font-weight:bold;">1,000,000</span></span>
        </div>
        <div style="display:flex; gap:15px; align-items:center;">
            <i class="fas fa-wifi"></i>
            <i class="fas fa-battery-full"></i>
            <span id="clock">12:00</span>
        </div>
    </div>

    <!-- Desktop -->
    <div id="desktop">
        <div class="icon-grid" id="icons"></div>
        <div class="widget-area">
            <div class="widget" style="background: linear-gradient(135deg, #FF9D6C, #BB4E75);">
                <h3><i class="fas fa-sun"></i> ÿßŸÑÿ∑ŸÇÿ≥</h3>
                <h1 style="font-size:3rem; margin:10px 0;">24¬∞C</h1>
                <p>ÿßŸÑÿØÿßÿ± ÿßŸÑÿ®Ÿäÿ∂ÿßÿ°ÿå ÿßŸÑŸÖÿ∫ÿ±ÿ®</p>
            </div>
            <div class="widget">
                <h3 style="color:var(--primary);">ÿ≠ÿßŸÑÿ© ÿßŸÑŸÜÿ∏ÿßŸÖ</h3>
                <div style="margin-top:10px; height:6px; background:#333; border-radius:10px; overflow:hidden;">
                    <div style="width:42%; height:100%; background:var(--primary);"></div>
                </div>
                <div style="font-size:0.8rem; margin-top:5px; display:flex; justify-content:space-between;">
                    <span>CPU: 42%</span> <span>RAM: 8GB</span>
                </div>
            </div>
            <!-- AI Widget -->
            <div class="widget" style="background: #151515;">
                <h3 style="color:#00e676;"><i class="fas fa-robot"></i> ŸÖÿ≥ÿßÿπÿØ ZENITH</h3>
                <p id="ai-resp" style="font-size:0.85rem; color:#ccc; margin:10px 0; height:40px;">ŸÖÿ±ÿ≠ÿ®ÿßŸã Ÿäÿß ŸÇÿßÿ¶ÿØ ÿ≠ÿßÿ™ŸÖÿå ŸÉŸäŸÅ ÿ£ÿ≥ÿßÿπÿØŸÉÿü</p>
                <input class="ai-input" id="ai-in" placeholder="ÿßŸÉÿ™ÿ® ÿ≥ÿ§ÿßŸÑŸÉ ŸáŸÜÿß..." onkeypress="if(event.key==='Enter') runAI()">
            </div>
        </div>
    </div>

    <div id="win-layer"></div>

    <!-- Start Menu -->
    <div id="start-menu">
        <div style="font-weight:bold; color:#aaa; margin-bottom:5px;">ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇÿßÿ™</div>
        <div id="start-list"></div>
        <div style="margin-top:10px; border-top:1px solid #444; padding-top:10px; display:flex; justify-content:space-between; align-items:center;">
            <div style="display:flex; align-items:center; gap:10px;">
                <div style="width:30px; height:30px; background:var(--primary); border-radius:50%; display:flex; align-items:center; justify-content:center; color:black; font-weight:bold;">H</div>
                <span>ÿßŸÑŸÇÿßÿ¶ÿØ ÿ≠ÿßÿ™ŸÖ</span>
            </div>
            <i class="fas fa-power-off" onclick="location.reload()" style="cursor:pointer; color:#ff5f57;"></i>
        </div>
    </div>

    <!-- Dock -->
    <div id="dock-container">
        <div id="dock">
            <div class="dock-item" onclick="toggleStart()"><i class="fas fa-th" style="color:#fff;"></i></div>
            <div style="width:1px; height:30px; background:rgba(255,255,255,0.2); margin:0 5px;"></div>
            <div id="dock-apps" style="display:flex; gap:15px;"></div>
        </div>
    </div>

    <div id="toast"><i class="fas fa-check-circle"></i> <span>ÿ™ŸÖ ÿßŸÑÿ™ÿ¥ÿ∫ŸäŸÑ</span></div>

    <script>
        // --- 1. SYSTEM CORE ---
        const System = {
            zIndex: 100,
            apps: {
                'files': { name: 'ÿßŸÑŸÖŸÑŸÅÿßÿ™', icon: 'fas fa-folder', color: '#ffca28', type: 'files' },
                'browser': { name: 'ÿßŸÑŸÖÿ™ÿµŸÅÿ≠', icon: 'fas fa-globe', color: '#00d2ff', type: 'web', url: 'https://bing.com' },
                'store': { name: 'ÿßŸÑŸÖÿ™ÿ¨ÿ±', icon: 'fas fa-store', color: '#f50057', type: 'store' },
                'term': { name: 'Terminal', icon: 'fas fa-terminal', color: '#00e676', type: 'term' },
                'paint': { name: 'ÿßŸÑÿ±ÿ≥ÿßŸÖ', icon: 'fas fa-palette', color: '#d500f9', type: 'paint' },
                'media': { name: 'ÿ≥ŸäŸÜŸÖÿß', icon: 'fas fa-play-circle', color: '#ff3d00', type: 'iframe', url: 'https://www.youtube.com/embed/jfKfPfyJRdk' },
                'games': { name: 'ÿßŸÑÿ£ŸÑÿπÿßÿ®', icon: 'fas fa-gamepad', color: '#ff9800', type: 'games' },
                'notes': { name: 'ŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™', icon: 'fas fa-sticky-note', color: '#ffea00', type: 'notes' },
                'settings': { name: 'ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™', icon: 'fas fa-cog', color: '#b0bec5', type: 'settings' }
            },

            init: function() {
                this.renderUI();
                this.bootSequence();
                this.startClock();
                this.liveUsers();
            },

            bootSequence: function() {
                const bar = document.getElementById('load-bar');
                const txt = document.getElementById('boot-text');
                
                setTimeout(() => { bar.style.width = '40%'; txt.innerText = "Loading Modules..."; }, 500);
                setTimeout(() => { bar.style.width = '80%'; txt.innerText = "Connecting to Satellite..."; }, 1500);
                setTimeout(() => { bar.style.width = '100%'; txt.innerText = "System Ready."; }, 2500);
                
                setTimeout(() => {
                    document.getElementById('boot-screen').style.opacity = '0';
                    setTimeout(() => document.getElementById('boot-screen').style.display = 'none', 1000);
                    this.showToast('ŸÖÿ±ÿ≠ÿ®ÿßŸã ÿ®ŸÉ ŸÅŸä ÿßŸÑÿπÿßŸÑŸÖ ÿßŸÑÿ¨ÿØŸäÿØ üåç');
                }, 3000);
            },

            renderUI: function() {
                const icons = document.getElementById('icons');
                const dock = document.getElementById('dock-apps');
                const start = document.getElementById('start-list');

                Object.keys(this.apps).forEach(key => {
                    const app = this.apps[key];
                    // Desktop Icons
                    icons.innerHTML += `
                    <div class="app-icon" onclick="WindowManager.open('${key}')">
                        <div class="icon-box"><i class="${app.icon}" style="color:${app.color}"></i></div>
                        <span>${app.name}</span>
                    </div>`;
                    
                    // Dock (Selected Apps)
                    if(['files','browser','store','paint','term','games'].includes(key)) {
                        dock.innerHTML += `<div class="dock-item" id="dock-${key}" onclick="WindowManager.open('${key}')"><i class="${app.icon}" style="color:${app.color}"></i></div>`;
                    }

                    // Start Menu List
                    start.innerHTML += `
                    <div class="start-item" onclick="WindowManager.open('${key}'); toggleStart()">
                        <i class="${app.icon}" style="color:${app.color}; width:25px;"></i>
                        <span>${app.name}</span>
                    </div>`;
                });
            },

            startClock: function() {
                setInterval(() => {
                    document.getElementById('clock').innerText = new Date().toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'});
                }, 1000);
            },

            liveUsers: function() {
                const el = document.getElementById('users-cnt');
                let count = 1000000;
                setInterval(() => {
                    count += Math.floor(Math.random() * 50) - 20;
                    el.innerText = count.toLocaleString();
                }, 2000);
            },

            showToast: function(msg) {
                const t = document.getElementById('toast');
                t.innerHTML = `<i class="fas fa-check-circle"></i> <span>${msg}</span>`;
                t.style.transform = 'translateX(0)';
                setTimeout(() => t.style.transform = 'translateX(150%)', 3000);
            }
        };

        // --- 2. WINDOW MANAGER ---
        const WindowManager = {
            open: function(key) {
                const app = System.apps[key];
                const wid = 'win-' + Date.now();
                const win = document.createElement('div');
                win.className = 'window';
                win.id = wid;
                win.style.zIndex = ++System.zIndex;
                win.style.width = '750px'; win.style.height = '500px';
                win.style.left = (50 + Math.random() * 50) + 'px';
                win.style.top = (50 + Math.random() * 50) + 'px';

                win.innerHTML = `
                    <div class="win-head" onmousedown="WindowManager.drag(event, '${wid}')">
                        <div class="win-controls">
                            <div class="win-dot close" onclick="WindowManager.close('${wid}')"></div>
                            <div class="win-dot min" onclick="document.getElementById('${wid}').style.display='none'"></div>
                            <div class="win-dot max" onclick="WindowManager.maximize('${wid}')"></div>
                        </div>
                        <div style="font-weight:500;">${app.name}</div>
                        <div style="width:50px;"></div>
                    </div>
                    <div class="win-body">${this.getContent(app, wid)}</div>
                `;

                win.onmousedown = () => win.style.zIndex = ++System.zIndex;
                document.getElementById('win-layer').appendChild(win);

                // Dock Animation
                const di = document.getElementById('dock-'+key);
                if(di) {
                    di.classList.add('active');
                    di.style.transform = 'translateY(-15px)';
                    setTimeout(() => di.style.transform = 'translateY(0)', 300);
                }

                if(app.type === 'paint') this.initPaint(wid);
                if(app.type === 'term') this.initTerm(wid);
            },

            close: function(wid) { document.getElementById(wid).remove(); },

            maximize: function(wid) {
                const w = document.getElementById(wid);
                if(w.style.width === '100%') {
                    w.style.width = '750px'; w.style.height = '500px'; w.style.top = '50px'; w.style.left = '50px'; w.style.borderRadius = '12px';
                } else {
                    w.style.width = '100%'; w.style.height = 'calc(100% - 35px)'; w.style.top = '35px'; w.style.left = '0'; w.style.borderRadius = '0';
                }
            },

            drag: function(e, wid) {
                const w = document.getElementById(wid);
                const dx = e.clientX - w.offsetLeft;
                const dy = e.clientY - w.offsetTop;
                const move = (ev) => { w.style.left = (ev.clientX - dx) + 'px'; w.style.top = (ev.clientY - dy) + 'px'; };
                document.addEventListener('mousemove', move);
                document.onmouseup = () => document.removeEventListener('mousemove', move);
            },

            getContent: function(app, wid) {
                if(app.type === 'web') return `<div style="display:flex; flex-direction:column; height:100%;"><div class="browser-bar"><i class="fas fa-globe" style="color:#aaa;"></i><input class="url-in" value="${app.url}" onchange="document.getElementById('f-${wid}').src=this.value"></div><iframe id="f-${wid}" src="${app.url}" style="flex:1; border:none; background:#fff;"></iframe></div>`;
                
                if(app.type === 'iframe') return `<iframe src="${app.url}" style="width:100%; height:100%; border:none;"></iframe>`;
                
                if(app.type === 'files') return `
                    <div style="display:flex; height:100%;">
                        <div style="width:180px; background:#181818; padding:15px;">
                            <div style="padding:8px; color:#aaa;"><i class="fas fa-hdd"></i> ÿßŸÑŸÇÿ±ÿµ C</div>
                            <div style="padding:8px; color:#aaa;"><i class="fas fa-cloud"></i> ÿßŸÑÿ™ÿÆÿ≤ŸäŸÜ ÿßŸÑÿ≥ÿ≠ÿßÿ®Ÿä</div>
                            <div style="padding:8px; color:#aaa;"><i class="fas fa-download"></i> ÿßŸÑÿ™ŸÜÿ≤ŸäŸÑÿßÿ™</div>
                        </div>
                        <div style="padding:20px; display:grid; grid-template-columns:repeat(auto-fill, minmax(90px, 1fr)); gap:15px; align-content:start; flex:1;">
                            <div style="text-align:center;"><i class="fas fa-folder" style="font-size:3rem; color:#ffca28;"></i><div>ŸÖÿ¥ÿßÿ±ŸäÿπŸä</div></div>
                            <div style="text-align:center;"><i class="fas fa-file-image" style="font-size:3rem; color:#fff;"></i><div>ÿµŸàÿ±ÿ©.png</div></div>
                            <div style="text-align:center;"><i class="fas fa-file-code" style="font-size:3rem; color:#00e676;"></i><div>code.js</div></div>
                        </div>
                    </div>`;

                if(app.type === 'paint') return `
                    <div style="display:flex; flex-direction:column; height:100%;">
                        <div class="paint-tools">
                            <div class="color-dot active" style="background:white" onclick="WindowManager.setColor('${wid}','white',this)"></div>
                            <div class="color-dot" style="background:#ff4757" onclick="WindowManager.setColor('${wid}','#ff4757',this)"></div>
                            <div class="color-dot" style="background:#2ed573" onclick="WindowManager.setColor('${wid}','#2ed573',this)"></div>
                            <div class="color-dot" style="background:#1e90ff" onclick="WindowManager.setColor('${wid}','#1e90ff',this)"></div>
                        </div>
                        <canvas id="cvs-${wid}" style="flex:1; background:#000; cursor:crosshair;"></canvas>
                    </div>`;

                if(app.type === 'term') return `
                    <div class="term-box" id="term-box-${wid}" onclick="document.getElementById('in-${wid}').focus()">
                        <div>ZENITH KERNEL [v10.5.2]</div>
                        <div>(c) Hatim Corporation. All rights reserved.</div><br>
                        <div id="logs-${wid}"></div>
                        <div style="display:flex;"><span>root@zenith:~$ </span><input id="in-${wid}" class="term-in" onkeypress="if(event.key==='Enter') WindowManager.runCmd('${wid}',this)"></div>
                    </div>`;

                if(app.type === 'games') return `
                    <div style="text-align:center; padding:20px; height:100%; display:flex; flex-direction:column; justify-content:center;">
                        <h2 style="color:var(--primary); margin-bottom:20px;">X-O: Tic Tac Toe</h2>
                        <div class="xo-board" id="xo-${wid}">
                            ${[0,1,2,3,4,5,6,7,8].map(i => `<div class="xo-cell" onclick="WindowManager.playXO('${wid}', this)"></div>`).join('')}
                        </div>
                        <button onclick="WindowManager.open('games'); WindowManager.close('${wid}')" style="margin-top:20px; padding:10px 20px; background:var(--primary); border:none; border-radius:5px; cursor:pointer;">ÿ•ÿπÿßÿØÿ© ÿßŸÑŸÑÿπÿ®</button>
                    </div>`;

                if(app.type === 'settings') return `
                    <div style="padding:30px;">
                        <h2>ÿÆŸÑŸÅŸäÿ© ÿßŸÑŸÜÿ∏ÿßŸÖ</h2>
                        <div style="display:flex; gap:15px; margin-top:20px;">
                            <div onclick="document.getElementById('wallpaper').style.backgroundImage='url(https://images.unsplash.com/photo-1534796636912-3b95b3ab5986?q=80&w=2072)'" style="width:100px; height:60px; background:#333; border:2px solid #555; cursor:pointer; background-image:url(https://images.unsplash.com/photo-1534796636912-3b95b3ab5986?q=80&w=2072); background-size:cover;"></div>
                            <div onclick="document.getElementById('wallpaper').style.backgroundImage='url(https://images.unsplash.com/photo-1451187580459-43490279c0fa?q=80&w=2072)'" style="width:100px; height:60px; background:#333; border:2px solid #555; cursor:pointer; background-image:url(https://images.unsplash.com/photo-1451187580459-43490279c0fa?q=80&w=2072); background-size:cover;"></div>
                            <div onclick="document.getElementById('wallpaper').style.backgroundImage='url(https://images.unsplash.com/photo-1506744038136-46273834b3fb?q=80&w=2072)'" style="width:100px; height:60px; background:#333; border:2px solid #555; cursor:pointer; background-image:url(https://images.unsplash.com/photo-1506744038136-46273834b3fb?q=80&w=2072); background-size:cover;"></div>
                        </div>
                    </div>`;

                if(app.type === 'store') return `
                    <div style="padding:20px; text-align:center;">
                        <h2 style="margin-bottom:20px;">ÿßŸÑŸÖÿ™ÿ¨ÿ± ÿßŸÑŸÉŸàŸÜŸä</h2>
                        <div style="display:grid; grid-template-columns:repeat(auto-fill, minmax(140px, 1fr)); gap:15px;">
                            ${['Discord', 'Spotify', 'VLC Player', 'Zoom', 'Photoshop', 'VS Code'].map(n => `
                                <div style="background:rgba(255,255,255,0.05); padding:15px; border-radius:10px; cursor:pointer;" onclick="System.showToast('ÿ™ŸÖ ÿ™ÿ´ÿ®Ÿäÿ™ ${n}')">
                                    <div style="width:50px; height:50px; background:#333; margin:0 auto 10px; border-radius:10px;"></div>
                                    <div style="font-weight:bold;">${n}</div>
                                    <button style="margin-top:10px; background:var(--primary); border:none; padding:5px 15px; border-radius:5px; cursor:pointer;">ÿ™ÿ´ÿ®Ÿäÿ™</button>
                                </div>`).join('')}
                        </div>
                    </div>`;

                if(app.type === 'notes') return `<textarea style="width:100%; height:100%; background:#1a1a1a; color:white; border:none; padding:20px; font-size:1.1rem; outline:none;" placeholder="ÿßŸÉÿ™ÿ® ŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™ŸÉ ŸáŸÜÿß..."></textarea>`;

                return `<div style="padding:20px;">ŸÖÿ≠ÿ™ŸàŸâ ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ</div>`;
            },

            // --- APP LOGIC ---
            
            // Paint
            initPaint: function(wid) {
                setTimeout(() => {
                    const c = document.getElementById(`cvs-${wid}`);
                    if(!c) return;
                    const ctx = c.getContext('2d');
                    c.width = c.clientWidth; c.height = c.clientHeight;
                    c.dataset.color = 'white';
                    let painting = false;
                    
                    const draw = (e) => {
                        if(!painting) return;
                        const rect = c.getBoundingClientRect();
                        ctx.lineWidth = 4; ctx.lineCap = 'round';
                        ctx.strokeStyle = c.dataset.color;
                        ctx.lineTo(e.clientX - rect.left, e.clientY - rect.top);
                        ctx.stroke(); ctx.beginPath(); ctx.moveTo(e.clientX - rect.left, e.clientY - rect.top);
                    };

                    c.onmousedown = (e) => { painting = true; draw(e); };
                    c.onmouseup = () => { painting = false; ctx.beginPath(); };
                    c.onmousemove = draw;
                }, 100);
            },
            setColor: function(wid, col, btn) {
                document.getElementById(`cvs-${wid}`).dataset.color = col;
                btn.parentElement.querySelectorAll('.color-dot').forEach(e => e.classList.remove('active'));
                btn.classList.add('active');
            },

            // Terminal
            initTerm: function(wid) { setTimeout(() => document.getElementById(`in-${wid}`).focus(), 100); },
            runCmd: function(wid, input) {
                const val = input.value.trim();
                const log = document.getElementById(`logs-${wid}`);
                input.value = '';
                log.innerHTML += `<div>root@zenith:~$ ${val}</div>`;
                
                let res = '';
                if(val === 'help') res = 'Commands: help, date, clear, whoami, reboot';
                else if(val === 'date') res = new Date().toString();
                else if(val === 'whoami') res = 'Commander Hatim (Admin)';
                else if(val === 'clear') { log.innerHTML = ''; return; }
                else if(val === 'reboot') { location.reload(); return; }
                else if(val) res = `Command not found: ${val}`;
                
                if(res) log.innerHTML += `<div style="color:#aaa;">${res}</div>`;
                document.getElementById(`term-box-${wid}`).scrollTop = document.getElementById(`term-box-${wid}`).scrollHeight;
            },

            // X-O Game
            playXO: function(wid, cell) {
                if(cell.innerText) return;
                cell.innerText = 'X'; cell.style.color = '#00d2ff';
                
                // Bot Move
                const cells = Array.from(document.querySelectorAll(`#xo-${wid} .xo-cell`));
                const empty = cells.filter(c => !c.innerText);
                if(empty.length > 0) {
                    const r = Math.floor(Math.random() * empty.length);
                    setTimeout(() => { empty[r].innerText = 'O'; empty[r].style.color = '#f80759'; }, 300);
                }
            }
        };

        // --- 3. GLOBAL FUNCTIONS ---
        function toggleStart() {
            document.getElementById('start-menu').classList.toggle('show');
        }

        function runAI() {
            const inp = document.getElementById('ai-in');
            const resp = document.getElementById('ai-resp');
            const val = inp.value.trim();
            if(!val) return;
            
            inp.value = '';
            resp.innerText = "ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ™ŸÅŸÉŸäÿ±...";
            
            setTimeout(() => {
                const answers = [
                    "ÿ®ÿßŸÑÿ™ÿ£ŸÉŸäÿØ Ÿäÿß ŸÇÿßÿ¶ÿØÿå ÿ≥ÿ£ŸÇŸàŸÖ ÿ®ÿ∞ŸÑŸÉ.",
                    "ŸÜÿ∏ÿßŸÖ ZENITH ŸäÿπŸÖŸÑ ÿ®ŸÉŸÅÿßÿ°ÿ© 100%.",
                    "Ÿáÿ∞ÿß ÿ≥ÿ§ÿßŸÑ ÿ∞ŸÉŸä! ÿßŸÑÿ•ÿ¨ÿßÿ®ÿ© ŸÖŸàÿ¨ŸàÿØÿ© ŸÅŸä ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™.",
                    "ÿßŸÑÿ¨Ÿà ÿ±ÿßÿ¶ÿπ ÿßŸÑŸäŸàŸÖ ŸÑŸÑÿ®ÿ±ŸÖÿ¨ÿ©.",
                    "ÿ™ŸÖ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿ∑ŸÑÿ®ŸÉ ŸÅŸä ÿßŸÑÿÆÿßÿØŸÖ."
                ];
                resp.innerText = answers[Math.floor(Math.random() * answers.length)];
            }, 1000);
        }

        document.addEventListener('click', (e) => {
            const start = document.getElementById('start-menu');
            const dock = document.getElementById('dock');
            if(start.classList.contains('show') && !start.contains(e.target) && !dock.contains(e.target)) {
                start.classList.remove('show');
            }
        });

        // Initialize
        System.init();

    </script>
</body>
</html>
